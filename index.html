<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>MJ's A2 Map</title>
</head>
<body>
	<input class="inputbox" id="searchbox" data-bind="textInput: searchText">
   <p class="test" data-bind="text: searchText"></p>
   <p class="test" data-bind="text: locationList()[0].match"></p>
	<ul class="locationListBox" data-bind="foreach:locationList">
		<li class="locationBox" data-bind="text: title, visible:isVisible"></li>
	</ul>
	<script type="text/javascript" src = "js/lib/knockout-3.4.1.js"></script>
	<script type="text/javascript">
		var locations = [{
               title:'Godaiko Japanese Restaurant',
               location:{
                  lat:42.2409745,
                  lng:-83.7698831
               },
               content:'First Dinner!'
            },
            {
               title:'Pita Pita',
               location:{
                  lat:42.248919,
                  lng:-83.654703
               },
               content:'Faverate Restaruant'
            },
            {
               title:'Chia Shiang',
               location:{
                  lat:42.2571668,
                  lng:-83.7299455
               },
               content:'Blacklist'
            }
      	];

      	//@constructor
      	var Location = function (data) {
      		this.title = ko.observable(data.title);
            this.location = ko.observable(data.location);
            //this.match = ko.observable(-1);
            this.isVisible = ko.observable(true);
      	};

      	//ViewModel for KnockOut
      	var ViewModel = function () {
      		//Always use self=this in KO ViewModel to avoid further complexity
      		var self = this;

      		//make location list
      		self.locationList = ko.observableArray([]);
      		locations.forEach( function(locationItem) {
      			self.locationList.push(new Location(locationItem));
      		});

            //input text
            self.searchText = ko.observable('');

            //match items
            self.search = ko.computed(function () {
               for(var i = 0, length1 = self.locationList().length; i < length1; i++){
                  var match =  self.locationList()[i].title().toLowerCase().indexOf(self.searchText().toLowerCase()) != -1;
                  if (!match) {
                     self.locationList()[i].isVisible(false);
                     console.log(self.locationList()[i].isVisible());
                  }else {
                     self.locationList()[i].isVisible(true);
                  };
               };
            },this);

      	};

      	ko.applyBindings(new ViewModel());
	</script>
</body>
</html>